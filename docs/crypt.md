# 暗号技術まとめ

## 基本用語
- ブロック暗号は、ビット列のまとまりごとに暗号化、復号化する暗号アルゴリズム
- ラウンドは、入力を暗号化し出力を得る1ステップのこと
- 暗号の方式は2種類あり、共通鍵暗号は暗号化と復号化で同じ鍵を利用する方式で、公開鍵暗号は暗号化と復号化で異なる鍵を利用する暗号アルゴリズムの方式である
- 鍵は数値であり、乱数生成器によって生成する
- 乱数は、見破られないための鍵の生成に必要である
- 擬似乱数は、ソフトウェアが生成する乱数は必ず周期を持つため真の乱数になりえないための表現である

## 脅威モデル
- なりすましは、誰かのふりをして不正に情報に関与すること
- 改ざんは、データの書き換えや破壊をすること
- 否認は、自身がした振る舞いを認めず否定すること
- 情報漏えいは、第三者に情報が漏れること
- サービス不能(Dos)は、大量のリクエストデータを送信し、使用できない状態にすること
- 権限の昇格は、本来はアクセス権限のないユーザーにアクセス権を扶養すること

## 共通鍵暗号(対称暗号)
- 共通鍵暗号方式は、鍵を受信者に送る必要があり鍵を盗まれるリスクがある(鍵配送問題)
- AES(Advanced Encryption Standard)は、共通鍵暗号方式のアルゴリズムの1つで、ブロックアルゴリズムのRijindael(ラインダール)を採用している
- AESは、現在主流の方式で安全性が高くパフォーマンスが良い

## 公開鍵暗号(非対称暗号)
- 公開鍵暗号は、**受信者が暗号鍵(公開鍵)と復号鍵(秘密鍵)を用意**して、暗号鍵を公開する方式
- 公開鍵暗号は、鍵配送問題を解決している
- 公開する鍵を公開鍵、受信者だけが利用する鍵を秘密鍵(プライベート鍵)と呼び、2つの鍵を鍵ペアと呼ぶ
- RSAは、大きな数の素因数分解を利用した公開鍵暗号のアルゴリズム
- RSAは3人の人名の頭文字である

## ハイブリット暗号
- ハイブリッド暗号は共通鍵暗号と公開鍵暗号を組み合わせた方式
- 送信者はメッセージを共通鍵で暗号化し、共通鍵を受信者の公開鍵で暗号化する
- 受信者は、暗号化された共通鍵を自身の秘密鍵で復号し、その共通鍵でメッセージを復号する

## 一方向ハッシュ関数
- 一方向ハッシュ関数は、入力をメッセージ、出力をハッシュ値とする関数である
- 一方向ハッシュ関数のハッシュ値の長さは、メッセージの長さによらず一定である
- 衝突耐性は、ハッシュ値が同一で、異なるメッセージが存在するかどうかの性質
- 一方向性は、ハッシュ値からはメッセージを逆算できない性質のこと
- MD5,SHA-1は、一方向ハッシュ関数の1つで、強衝突性が破られており(衝突耐性がない)安全ではない
- SHA-2(SHA-256,SHA-384,SHA-512),SHA-3は、一方向ハッシュ関数の1つで、強衝突性が破られておらず、安全である
- ソルトは、乱数でありパスワードの平文とともに一方向ハッシュ関数に入力される
- ストレッチングは、一方向ハッシュ関数を何度も通すこと

## メッセージ認証コード(Message Authentication Code: MAC)
- メッセージ認証コードは、共通鍵暗号の仕組みを利用して、メッセージが改ざんやなりすましを検出する仕組み
- メッセージ認証コードは、事前に送信者と受信者で鍵を共有し、メッセージと鍵からMAC値を算出する
- HMACは一方向ハッシュ関数を用いてメッセージ認証コードを構成する手法

## デジタル署名(電子署名)
- デジタル署名は、メッセージの署名作成と署名検証検証によって、改ざんやなりすましを検出し、否認を防止する仕組み
- デジタル署名の仕組みは公開鍵暗号の逆であり、**送信者が公開鍵と秘密鍵を作成し、秘密鍵でメッセージを暗号化し(署名)**、受信者は公開鍵でメッセージを復号化する
- デジタル署名のアルゴリズムには、RSAがよく利用される

## 証明書
- 公開鍵証明書は、公開鍵が本人のものであることを証明するもので、公開鍵と認証局の署名が付されている
- 公開鍵基盤・PKI(Public Key Infrastracture)は公開鍵の安全性を保証するしくみ
- 認証局は、証明書の発行者のことで、認証局自体が正しいことを証明するためにルート認証局(CA)が存在する
- セルフ署名は、自分自身の公開鍵に対して署名を行うことで、ルートCAが利用する
- X.509は証明書のフォーマットで、発行社や有効期限が記載されている

## SSL証明書
- SSL証明書は、サーバーが正しいことを証明するもの
- SSL証明書には、公開鍵、サーバーの署名、サーバーの情報が必要となる
- SSLサーバー証明書は公開鍵であり、CSRを介して生成され秘密鍵とペアになるように構成されている
- SSLサーバー証明書がインストールされたサーバーの公開鍵で暗号化された場合、秘密鍵で複合できる

## SSL/TLS
- SSL/TLSは、暗号通信の枠組みを提供するもの
- SSLは、盗聴への対策としてハイブリッド暗号を利用している
- SSLは、改ざんへの対策としてMACを利用している
- SSLは、なりすましへの対策として署名を利用している
- TLSは、サーバー認証(必須)、クライアント認証(オプション)を経て共通鍵を生成し、共通鍵暗号によって暗号化を行う通信方式である
- 暗号スイートは、SSL/TLS通信に置ける適切な暗号技術の組み合わせのこと
- サーバー認証は、SSL/TLSにおいて必須であり、サーバー証明書をクライアントに送付する
- クライアント認証は、SSL/TLSにおいてオプションであり、クライアント証明書をサーバーに送付する。特定のユーザーのみにサーバーを公開したい場合に有効である
- CSR(Certificate Signing Request:証明書署名要求)は、SSL証明書を発行するための申請書のようなもの
- SSL通信
  - サーバーは、サーバー証明書をインストールし、秘密鍵、公開鍵、証明書を保存する
  - サーバーは、サーバー証明書(公開鍵が含まれる)をクライアントへ送信する
  - クライアントは、共通鍵を作成しサーバー証明書に含まれる(サーバーの)公開鍵で暗号化し、サーバーへ送付する
  - サーバーは、暗号化された共通鍵を秘密鍵で復号し、以降の通信では共通鍵を用いてメッセージを暗号化する
  - クライアントも同様に、作成した共通鍵を用いてメッセージを暗号化する
- OpenSSLは、TLSを担うライブラリのこと
